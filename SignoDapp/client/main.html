<head>
    <title>Signo pre-Alpha</title>
</head>


<body>
<h1>Signo pre-Alpha</h1>

<hr> {{> WalletBallance}}
<hr> {{> CandidateSearch}}
<hr> {{> createCertificate}}
<hr> {{> DeleteCertificate}}
<hr> {{> UpdateCertificate}}
<hr>
</body>

<template name="WalletBallance">
    <p>Your wallet adress is:{{getEthBallance}} {{TemplateVar.get "walletAddress"}} </p>
    <p>Your ETH ballance is:{{getEthBallance}} {{TemplateVar.get "walletBallance"}} ETH</p>
</template>

<template name="CandidateSearch">
    <h1> Search for a Candidate</h1>

    <form class="candidateSearch">
        <h2>Select Search Method</h2>
        <input type="radio" class="searchType" name="searchType" value="candidateNameDOB" checked>Candidate Name and DOB
        <input type="radio" class="searchType" name="searchType" value="candidateIdHash">Candidate ID Hash
        <input type="radio" class="searchType" name="searchType" value="certificateAddress">Certificate Address
        <input type="radio" class="searchType" name="searchType" value="certificateIssuer">Certificate Issuer
        <br>
        <input type="submit" value="Find Certificate"/>
        <input type="button" class="resetSearch" value="Reset Search"/>
        <br> {{#if compare searchType "candidateNameDOB"}}
        <label> Candidate Info: </label>
        <input type="text" name="candidateName" placeholder="Vitalik"/>
        <input type="date"
               name="candidateDOB"/> {{> searchResultsList searchResults=searchResults commonMetaData=commonMetaData
            commonMetaDataText=commonMetaDataText}} {{/if}} {{#if compare searchType "candidateIdHash"}}
        <label> Candidate ID Hash: </label>
        <input type="text" name="idHash"
               placeholder="ID Hash"/> {{> searchResultsList searchResults=searchResults commonMetaData=commonMetaData
            commonMetaDataText=commonMetaDataText}} {{/if}} {{#if compare searchType "certificateAddress"}}
        <label>Certificate Adress: </label>
        <input type="text" name="certificateAddress"
               placeholder="Certificate Public Key"/>{{> searchResultsList searchResults=searchResults
            commonMetaData=commonMetaData commonMetaDataText=commonMetaDataText}}{{/if}} {{#if compare searchType
                                                                                               "certificateIssuer"}}
        <label>Issuer Address: </label>
        <input type="text" name="certificateIssuer"
               placeholder="Institute Public Key"/> {{> searchResultsList searchResults=searchResults
            commonMetaData=commonMetaData commonMetaDataText=commonMetaDataText}}{{/if}}


    </form>
</template>

<template name="searchResultsList">
    {{#if searchResults}}
        <div style="background-color:green;color:pink;padding:20px;">
            <div style="background-color:yellow;color:blue;padding:20px;">
                <h2>Your Search Results are:</h2>
                {{> candidateCommonMetaData commonMetaDataText=commonMetaDataText}}
            </div>
            {{#each result in searchResults}} {{#with
                    result}} {{> ChildCertificate resultCertificateAddress=certificateAddress resultTimeStamp=timeStamp issuerMetaData=issuerMetaData}}
            {{/with}} {{/each}}
        </div>
    {{/if}}
</template>

<template name="candidateCommonMetaData">
    <div style="background-color:brown;color:yellow;padding:20px;">
        <p>{{commonMetaDataText}}</p>
    </div>
</template>

<template name="ChildCertificate">
    {{#unless TemplateVar.get "isDeleted"}}
        <div style="background-color:pink;color:green;padding:20px;">

            <h3>Certificate infomation is below</h3>
            <p>Certificate public address: {{TemplateVar.get "certificateAddress"}}</p>
            <p> Date created: {{formatDate resultTimeStamp}}</p>
            <p>ID Hash: {{TemplateVar.get "idHash"}}</p>
            <p>Certificate issuer address: {{TemplateVar.get "certificateIssuer"}}</p>
            {{#if TemplateVar.get "issuerMetaData"}}
                <p># of certificates issued by issuer: {{TemplateVar.get "issuerMetaData"}}</p>
            {{/if}}
            <table>
                <tr>
                    <th>Field</th>
                    <th>Value</th>
                </tr>
                {{#each objectToPairs (TemplateVar.get "sundryData")}}
                    <tr>
                        <td>{{key}}</td>
                        <td>{{value}}</td>
                    </tr>
                {{/each}}
            </table>
        </div>
    {{/unless}}
</template>

<template name="DeleteCertificate">
    <h1>Delete certificates</h1>
    <h2>You can delete certificates here in case the information is incorrect</h2>
    {{> DeleteCertificateForm}}
</template>

<template name="DeleteCertificateForm">
    <form class="deleteCertificateForm">
        <input type="text" name="certificateAddress" placeholder="0x0123456789abcdef012345679abcdef0123456"/>
        <input type="submit" class="deleteCertificate" value="Delete Certificate"/>
    </form>
</template>

<template name="UpdateCertificate">
    <h1>Update certificates</h1>
    <h2>You can update certificates here in case the information is incorrect</h2>
    {{> UpdateCertificateForm}}
</template>

<template name="UpdateCertificateForm">
    <form class="updateCertificateForm">
        <input type="text" name="certificateAddress" placeholder="0x0123456789abcdef012345679abcdef0123456"/>
        <input type="submit" class="findCertificate" value="Find Certificate"/>
    </form>
    {{#if updateCertificateSearchResults}}
        {{>UpdateCertificateFormChild updateCertificateSearchResults=updateCertificateSearchResults}}
    {{/if}}
</template>

<template name="UpdateCertificateFormChild">
    {{#if (TemplateVar.get "json")}}
        {{>UpdateCertificateFormChildChild json=(TemplateVar.get "json")}}
        <br>
        Is anonymous? <input type="checkbox" id="anonymousUpdate" {{updateCheckboxAnonymous}}>
        <button type="submit" id="update">Update</button>
    {{/if}}
</template>

<template name="UpdateCertificateFormChildChild">
    {{#each inputs}}
        {{> inputFields}}
    {{/each}}
</template>

<template name="createCertificate">
    <h2>Create a new Certificate</h2>
    <lable>Pick a template:</lable>
    <select name="certificatesTemplates" id="certificatesTemplates">
        {{#each template in certificatesTemplates}}
            <option value="{{template.id}}">{{template.name}}</option>
            {{/each}}
    </select>
    <br>
    {{#each inputs}}
        {{> inputFields}}
    {{/each}}
    <br>
    <button id='add-input'>
        Add Input
    </button>
    <br>
    Is anonymous?<input type="checkbox" id="anonymousCreate">
    <button type="submit" id="createCertificate">Create</button>

</template>

<template name='inputFields'>
    <input name='inputKey' class='inputKey' type='text' uniqid="{{uniqid}}" value="{{keyValue}}" {{readOnly}}>
    <input name='inputValue' class='inputValue' type='{{type}}' uniqid="{{uniqid}}" value="{{value}}">
    {{#unless readOnly}}
        <button class='remove-input' uniqid="{{uniqid}}">Remove</button>
    {{/unless}}
    <br>
</template>
